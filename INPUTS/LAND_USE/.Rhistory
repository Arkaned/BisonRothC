SUM_Max_BAU <- SUM_Max_BAU + (Max_BAU[val] - Med_BAU[val])
SUM_Min_BAU <- SUM_Min_BAU + (Min_BAU[val] - Med_BAU[val])
SUM_Max_SSM <- SUM_Max_SSM + (Max_SSM[val] - Med_BAU[val])
#SUM_Med_SSM <- SUM_Med_SSM + (Med_SSM[val] - Med_BAU[val])
SUM_Min_SSM <- SUM_Min_SSM + (Min_SSM[val] - Med_BAU[val])
if (val%%100 == 0) {print(val)}
}
sum_Diff <- data.frame(#SUM_Max_BAU,
#SUM_Min_BAU,
#SUM_Max_SSM,
#SUM_Med_SSM,
#SUM_Min_SSM,
Max_BAU,
Max_SSM,
#Med_BAU,
#Med_SSM,
Min_BAU,
Min_SSM
)
melted <- melt(sum_Diff)
ggplot(melted) +
geom_boxplot(aes(x=variable, y=value, color=variable, fill=variable)) +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(mapping=aes(x=variable, y=value), color="black", size=0.1, alpha=0.1) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("A boxplot with jitter") +
xlab("")
sum_Diff <- data.frame(#SUM_Max_BAU,
SUM_Min_BAU,
#SUM_Max_SSM,
#SUM_Med_SSM,
SUM_Min_SSM,
#Max_BAU,
#Max_SSM,
#Med_BAU,
#Med_SSM,
#Min_BAU,
#Min_SSM
)
sum_Diff <- data.frame(#SUM_Max_BAU,
SUM_Min_BAU,
#SUM_Max_SSM,
#SUM_Med_SSM,
SUM_Min_SSM
#Max_BAU,
#Max_SSM,
#Med_BAU,
#Med_SSM,
#Min_BAU,
#Min_SSM
)
melted <- melt(sum_Diff)
ggplot(melted, aes(x=variable, y=value)) +
geom_bar(stat="identity")
sum_Diff <- data.frame(SUM_Max_BAU,
SUM_Min_BAU,
SUM_Max_SSM,
#SUM_Med_SSM,
SUM_Min_SSM
#Max_BAU,
#Max_SSM,
#Med_BAU,
#Med_SSM,
#Min_BAU,
#Min_SSM
)
melted <- melt(sum_Diff)
ggplot(melted, aes(x=variable, y=value)) +
geom_bar(stat="identity")
sum_Diff <- data.frame(SUM_Max_BAU,
SUM_Max_SSM,
SUM_Min_BAU,
#SUM_Med_SSM,
SUM_Min_SSM
#Max_BAU,
#Max_SSM,
#Med_BAU,
#Med_SSM,
#Min_BAU,
#Min_SSM
)
melted <- melt(sum_Diff)
ggplot(melted, aes(x=variable, y=value)) +
geom_bar(stat="identity")
ggplot(melted) +
geom_boxplot(aes(x=variable, y=value, color=variable, fill=variable)) +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(mapping=aes(x=variable, y=value), color="black", size=0.1, alpha=0.1) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("A boxplot with jitter") +
xlab("")
diff_Dat <- data.frame(Max_BAU,
Max_SSM,
Min_BAU,
Max_BAU)
diff_Dat <- data.frame(Max_BAU,
Max_SSM,
Min_BAU,
Min_SSM)
melted_diff <- (diff_Dat)
ggplot(melted) +
geom_boxplot(aes(x=variable, y=value, color=variable, fill=variable)) +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(mapping=aes(x=variable, y=value), color="black", size=0.1, alpha=0.1) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("A boxplot with jitter") +
xlab("")
ggplot(mmelted_diff) +
geom_boxplot(aes(x=variable, y=value, color=variable, fill=variable)) +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(mapping=aes(x=variable, y=value), color="black", size=0.1, alpha=0.1) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("A boxplot with jitter") +
xlab("")
ggplot(melted_diff) +
geom_boxplot(aes(x=variable, y=value, color=variable, fill=variable)) +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(mapping=aes(x=variable, y=value), color="black", size=0.1, alpha=0.1) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("A boxplot with jitter") +
xlab("")
melted_diff
melted_diff <- melted(diff_Dat)
melted_diff <- melt(diff_Dat)
ggplot(melted_diff) +
geom_boxplot(aes(x=variable, y=value, color=variable, fill=variable)) +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(mapping=aes(x=variable, y=value), color="black", size=0.1, alpha=0.1) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("A boxplot with jitter") +
xlab("")
mean(Max_BAU)
Max_BAU
mean(Max_BAU[!is.na(Max_BAU)])
mean(Max_SSM[!is.na(Max_SSM)])
52*4730
52*4000
Max_SSM
length(Max_SSM[is.na(Max_SSM)])
length(Max_BAU[is.na(Max_BAU)])
sum_Diff <- data.frame(SUM_Max_BAU,
SUM_Max_SSM,
SUM_Min_BAU,
#SUM_Med_SSM,
SUM_Min_SSM
#Max_BAU,
#Max_SSM,
#Med_BAU,
#Med_SSM,
#Min_BAU,
#Min_SSM
)
melted_sum <- melt(sum_Diff)
melted_sum
length(SUM_Max_BAU[is.na(SUM_Max_BAU)])
length(SUM_Max_BAU
)
foward_dat[, 14]
foward_dat[, 13]
foward_dat[, 3]
foward_dat[, 16]
foward_dat[, 15]
foward_dat[, 11]
val=1
Max_BAU[val] - Med_BAU[val]
Max_SSM[val] - Med_BAU[val]
val=2
Max_BAU[val] - Med_BAU[val]
Max_SSM[val] - Med_BAU[val]
FOWARD
FOWARD[,11:21]
WD_F<-("H:/BisonRothC/OUTPUTS/3_FORWARD/FOWARD_AOI_final")
WD_SOC<-("H:/BisonRothC/INPUTS/SOC_MAP")
WD_AOI<-("H:/BisonRothC/INPUTS/AOI_POLYGON")
WD_MAPS<-("H:/BisonRothC/OUTPUTS/4_MAPS")
#Define the name of the Country ("ISO3CountryCode")
name<-"Bialowieza"
setwd(WD_F)
FOWARD<-read_sf("FOWARD_AOI_final.shp")
setwd(WD_SOC)
SOC_MAP<-raster::raster(c("SOC_MAP_AOI.tif"))
empty_raster<-SOC_MAP*0
setwd(WD_AOI)
Country<-read_sf(c("Bialowieza_Forest_3_2.shp"))
# Cut the raster with the country vector
Country_raster<-crop(empty_raster,Country)
FOWARD[is.na(FOWARD)] <- 0
setwd(WD_MAPS)
FOWARD
setwd(WD_F)
FOWARD<-read_sf("FOWARD_AOI_final.shp")
foward_vis <- terra::vect("FOWARD_AOI_final.shp)
foward_vis <- terra::vect("FOWARD_AOI_final.shp")
foward_vis
Max_BAU2 <- c()
Min_BAU2 <- c()
Med_BAU2 <- c()
Max_SSM2 <- c()
Med_SSM2 <- c()
Min_SSM2 <- c()
SUM_Max_BAU2 <- 0
SUM_Min_BAU2 <- 0
SUM_Med_BAU2 <- 0
SUM_Max_SSM2 <- 0
SUM_Med_SSM2 <- 0
SUM_Min_SSM2 <- 0
length(foward_vis)
Max_BAU2 <- c()
Min_BAU2 <- c()
Med_BAU2 <- c()
Max_SSM2 <- c()
Med_SSM2 <- c()
Min_SSM2 <- c()
SUM_Max_BAU2 <- 0
SUM_Min_BAU2 <- 0
SUM_Med_BAU2 <- 0
SUM_Max_SSM2 <- 0
SUM_Med_SSM2 <- 0
SUM_Min_SSM2 <- 0
for (val in 1:length(foward_vis)){
if(is.na(foward_vis[,2][[1]][[1]][val]) | foward_vis[,2][[1]][[1]][val] == 0) {next}
Max_BAU2[val] <- foward_vis[, 14][[1]][[1]][val]
Min_BAU2[val] <- foward_vis[, 13][[1]][[1]][val]
Med_BAU2[val] <- foward_vis[, 3][[1]][[1]][val]
Max_SSM2[val] <- foward_vis[, 16][[1]][[1]][val]
Med_SSM2[val] <- foward_vis[, 11][[1]][[1]][val]
Min_SSM2[val] <- foward_vis[, 15][[1]][[1]][val]
# now calculate the difference between everything and such without bison...
SUM_Max_BAU2 <- SUM_Max_BAU + (Max_BAU[val] - Med_BAU[val])
SUM_Min_BAU2 <- SUM_Min_BAU + (Min_BAU[val] - Med_BAU[val])
SUM_Max_SSM2 <- SUM_Max_SSM + (Max_SSM[val] - Med_BAU[val])
#SUM_Med_SSM <- SUM_Med_SSM + (Med_SSM[val] - Med_BAU[val])
SUM_Min_SSM2 <- SUM_Min_SSM + (Min_SSM[val] - Med_BAU[val])
if (val%%100 == 0) {print(val)}
}
ggplot(melted_sum, aes(x=variable, y=value)) +
geom_bar(stat="identity")
sum_Diff <- data.frame(SUM_Max_BAU,
SUM_Max_SSM,
SUM_Min_BAU,
#SUM_Med_SSM,
SUM_Min_SSM
#Max_BAU,
#Max_SSM,
#Med_BAU,
#Med_SSM,
#Min_BAU,
#Min_SSM
)
diff_Dat <- data.frame(Max_BAU,
Max_SSM,
Min_BAU,
Min_SSM)
melted_sum <- melt(sum_Diff)
ggplot(melted_sum, aes(x=variable, y=value)) +
geom_bar(stat="identity")
melted_diff <- melt(diff_Dat)
ggplot(melted_diff) +
geom_boxplot(aes(x=variable, y=value, color=variable, fill=variable)) +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(mapping=aes(x=variable, y=value), color="black", size=0.1, alpha=0.1) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("A boxplot with jitter") +
xlab("")
sum_Diff2 <- data.frame(SUM_Max_BAU2,
SUM_Max_SSM2,
SUM_Min_BAU2,
#SUM_Med_SSM,
SUM_Min_SSM2
#Max_BAU,
#Max_SSM,
#Med_BAU,
#Med_SSM,
#Min_BAU,
#Min_SSM
)
diff_Dat2 <- data.frame(Max_BAU2,
Max_SSM2,
Min_BAU2,
Min_SSM2)
sum_Diff2 <- data.frame(SUM_Max_BAU2,
SUM_Max_SSM2,
SUM_Min_BAU2,
#SUM_Med_SSM,
SUM_Min_SSM2
#Max_BAU,
#Max_SSM,
#Med_BAU,
#Med_SSM,
#Min_BAU,
#Min_SSM
)
diff_Dat2 <- data.frame(Max_BAU2,
Max_SSM2,
Min_BAU2,
Min_SSM2)
melted_sum2 <- melt(sum_Diff2)
ggplot(melted_sum2, aes(x=variable, y=value)) +
geom_bar(stat="identity")
melted_diff2 <- melt(diff_Dat2)
ggplot(melted_diff2) +
geom_boxplot(aes(x=variable, y=value, color=variable, fill=variable)) +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(mapping=aes(x=variable, y=value), color="black", size=0.1, alpha=0.1) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("A boxplot with jitter") +
xlab("")
ggplot(melted_sum2, aes(x=variable, y=value)) +
geom_bar(stat="identity")
sum_Diff2 <- data.frame(SUM_Max_BAU2,
SUM_Max_SSM2,
Med_BAU,
Med_SSM,
SUM_Min_BAU2,
#SUM_Med_SSM,
SUM_Min_SSM2
#Max_BAU,
#Max_SSM,
#Min_BAU,
#Min_SSM
)
diff_Dat2 <- data.frame(Max_BAU2,
Max_SSM2,
Min_BAU2,
Min_SSM2)
melted_sum2 <- melt(sum_Diff2)
ggplot(melted_sum2, aes(x=variable, y=value)) +
geom_bar(stat="identity")
melted_diff2 <- melt(diff_Dat2)
ggplot(melted_diff2) +
geom_boxplot(aes(x=variable, y=value, color=variable, fill=variable)) +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(mapping=aes(x=variable, y=value), color="black", size=0.1, alpha=0.1) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("A boxplot with jitter") +
xlab("")
diff_Dat2 <- data.frame(Max_BAU2,
Max_SSM2,
Med_BAU,
Med_SSM,
Min_BAU2,
Min_SSM2)
melted_sum2 <- melt(sum_Diff2)
ggplot(melted_sum2, aes(x=variable, y=value)) +
geom_bar(stat="identity")
melted_diff2 <- melt(diff_Dat2)
ggplot(melted_diff2) +
geom_boxplot(aes(x=variable, y=value, color=variable, fill=variable)) +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(mapping=aes(x=variable, y=value), color="black", size=0.1, alpha=0.1) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("A boxplot with jitter") +
xlab("")
sens_data <- vect("H:/BisonRothC/Statistics/Sensitivity_analysis_F_run/Sensitivity_analysis_F_run.shp")
sens_Data
# Then, we will open the SOC layer and the clay layer.
#Open SOC MAP
setwd(WD_SOC)
SOC_MAP_AOI<-rast(c("SOC_MAP_AOI.tif"))
plot(SOC_MAP_AOI)
# Points to Raster initial SOC (t0) 2018/2020
Country_SOC_2018_Map<-rasterize(FOWARD, Country_raster ,FOWARD$SOC_t0, update=TRUE)
writeRaster(Country_SOC_2018_Map,filename="_GSOCseq_T0_Map030.tiff",overwrite=TRUE)
plot(Country_SOC_2018_Map)
# Points to Raster Med Scenario
Country_Med_2040_Map<-rasterize(FOWARD, Country_raster ,FOWARD$Med_Scena0, update=TRUE)
# Points to Raster Med Scenario
Country_Med_2040_Map<-rasterize(FOWARD, Country_raster ,FOWARD$Med_Scena0, update=TRUE)
WD_F<-("H:/BisonRothC/OUTPUTS/3_FORWARD/FOWARD_AOI_final")
WD_SOC<-("H:/BisonRothC/INPUTS/SOC_MAP")
WD_AOI<-("H:/BisonRothC/INPUTS/AOI_POLYGON")
WD_MAPS<-("H:/BisonRothC/OUTPUTS/4_MAPS")
#Define the name of the Country ("ISO3CountryCode")
name<-"Bialowieza"
setwd(WD_F)
FOWARD<-read_sf("FOWARD_AOI_final.shp")
setwd(WD_SOC)
SOC_MAP<-raster::raster(c("SOC_MAP_AOI.tif"))
empty_raster<-SOC_MAP*0
setwd(WD_AOI)
Country<-read_sf(c("Bialowieza_Forest_3_2.shp"))
# Cut the raster with the country vector
Country_raster<-crop(empty_raster,Country)
FOWARD[is.na(FOWARD)] <- 0
setwd(WD_MAPS)
Country_BAU_2040_Map<-rasterize(FOWARD, Country_raster, field=FOWARD$SOC_BAU_20, update=TRUE)
writeRaster(Country_BAU_2040_Map,filename=paste0(name,"_GSOCseq_finalSOC_BAU_Map030.tiff"),overwrite=TRUE)
# Points to Raster Low Scenario
Country_Lwr_2040_Map<-rasterize(FOWARD, Country_raster ,FOWARD$Low_Scena0, update=TRUE)
writeRaster(Country_Lwr_2040_Map,filename="_GSOCseq_finalSOC_SSM1_Map030.tiff",overwrite=TRUE)
# Points to Raster Med Scenario
Country_Med_2040_Map<-rasterize(FOWARD, Country_raster ,FOWARD$Med_Scena0, update=TRUE)
writeRaster(Country_Med_2040_Map,filename="_GSOCseq_finalSOC_SSM2_Map030.tiff",overwrite=TRUE)
# Points to Raster High Scenario
Country_Hgh_2040_Map<-rasterize(FOWARD, Country_raster ,FOWARD$High_Scen0, update=TRUE)
writeRaster(Country_Hgh_2040_Map,filename="_GSOCseq_finalSOC_SSM3_Map030.tiff",overwrite=TRUE)
# Points to Raster initial SOC (t0) 2018/2020
Country_SOC_2018_Map<-rasterize(FOWARD, Country_raster ,FOWARD$SOC_t0, update=TRUE)
writeRaster(Country_SOC_2018_Map,filename="_GSOCseq_T0_Map030.tiff",overwrite=TRUE)
plot(Country_SOC_2018_Map)
plot_Med_2040_Map
plot(Country_Med_2040_Map)
plot(Country_SOC_2018_Map, box=FALSE)
plot(Country_SOC_2018_Map, box=FALSE)
plot(terra::rast(Country_SOC_2018_Map), box=FALSE)
terra::plot(terra::rast(Country_SOC_2018_Map), box=FALSE)
terra::plot(terra::rast(Country_SOC_2018_Map))
terra::plot(Country_SOC_2018_Map)
plot(terra:rast(Country_SOC_2018_Map))
plot(Country_SOC_2018_Map)
plot(Country_SOC_2018_Map)
terra::plot(terra::rast(Diff_Md_BAU_2040),
col=colorRampPalette(c("blue", "cyan", "green"))(4000),
axes=FALSE,
box=FALSE,
plg=list(cex = 4))
# Then, we will open the land use layer (latest available year) created in script number 10.
setwd(WD_LU)
LU_AOI<-rast(c("ESA_Land_Cover_12clases_FAO_AOI.tif"))
plot(LU_AOI)
WD_AOI<-("H:/BisonRothC/INPUTS/AOI_POLYGON")
WD_SOC<-("H:/BisonRothC/INPUTS/SOC_MAP")
WD_CLAY<-("H:/BisonRothC/INPUTS/CLAY")
WD_CLIM<-("H:/BisonRothC/INPUTS/TERRA_CLIMATE_1")
WD_LU<-("H:/BisonRothC/INPUTS/LAND_USE")
WD_COV<-("H:/BisonRothC/INPUTS/COV")
WD_STACK<-("H:/BisonRothC/INPUTS/STACK")
# Open the shapefile of the region/country
setwd(WD_AOI)
AOI<-vect("Bialowieza_Forest_3_2.shp")
# Then, we will open the SOC layer and the clay layer.
#Open SOC MAP
setwd(WD_SOC)
SOC_MAP_AOI<-rast(c("SOC_MAP_AOI.tif"))
plot(SOC_MAP_AOI)
# Open Clay layers  (ISRIC)
setwd(WD_CLAY)
Clay_WA_AOI<-rast(c("Clay_WA_AOI.tif"))
Clay_WA_AOI_res<-resample(Clay_WA_AOI,SOC_MAP_AOI,method='bilinear')
#arkan's little plots:
plot(Clay_WA_AOI_res)
#Then we will open the 2000-2020 average climate layers created (as the one created in script number 2)
#Open Precipitation layer (CRU https://crudata.uea.ac.uk/cru/data/hrg/)
setwd(WD_CLIM)
PREC<-rast(c("Prec_Stack_01-19_TC.tif"))
PREC_AOI<-crop(PREC,AOI)
PREC_AOI<-resample(PREC_AOI,SOC_MAP_AOI)
PREC_AOI<-mask(PREC_AOI,AOI)
PREC_AOI<-c(PREC_AOI)
# arkan's little plots:
plot(PREC_AOI)
#Open Temperatures layer (CRU https://crudata.uea.ac.uk/cru/data/hrg/)
TEMP<-rast(c("Temp_Stack_01-19_TC.tif"))
TEMP_AOI<-crop(TEMP,AOI)
TEMP_AOI<-resample(TEMP_AOI,SOC_MAP_AOI)
TEMP_AOI<-mask(TEMP_AOI,AOI)
TEMP_AOI<-c(TEMP_AOI)
#arkan's little plots:
plot(TEMP_AOI)
#Open Potential Evapotranspiration layer (CRU https://crudata.uea.ac.uk/cru/data/hrg/)
PET<-rast(c("PET_Stack_01-19_TC.tif"))
PET_AOI<-crop(PET,AOI)
PET_AOI<-resample(PET_AOI,SOC_MAP_AOI)
PET_AOI<-mask(PET_AOI,AOI)
PET_AOI<-c(PET_AOI)
#arkan's little plots:
plot(PET_AOI)
# Then, we will open the land use layer (latest available year) created in script number 10.
setwd(WD_LU)
LU_AOI<-rast(c("ESA_Land_Cover_12clases_FAO_AOI.tif"))
plot(LU_AOI)
plot(LU_AOI)
